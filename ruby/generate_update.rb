table_name = "census"
stage_name = "pt1_staging"

part1_cols=[
 {"id"=>"P0010001", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010002", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010003", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010004", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010005", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010006", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010007", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010008", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010009", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010010", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010011", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010012", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010013", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010014", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010015", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010016", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010017", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010018", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010019", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010020", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010021", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010022", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010023", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010024", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010025", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010026", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010027", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010028", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010029", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010030", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010031", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010032", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010033", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010034", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010035", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010036", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010037", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010038", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010039", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010040", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010041", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010042", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010043", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010044", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010045", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010046", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010047", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010048", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010049", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010050", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010051", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010052", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010053", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010054", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010055", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010056", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010057", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010058", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010059", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010060", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010061", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010062", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010063", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010064", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010065", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010066", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010067", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010068", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010069", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010070", "type"=>"Integer", "len"=>4},
 {"id"=>"P0010071", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020001", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020002", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020003", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020004", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020005", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020006", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020007", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020008", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020009", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020010", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020011", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020012", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020013", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020014", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020015", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020016", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020017", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020018", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020019", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020020", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020021", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020022", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020023", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020024", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020025", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020026", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020027", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020028", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020029", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020030", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020031", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020032", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020033", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020034", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020035", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020036", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020037", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020038", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020039", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020040", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020041", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020042", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020043", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020044", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020045", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020046", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020047", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020048", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020049", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020050", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020051", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020052", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020053", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020054", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020055", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020056", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020057", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020058", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020059", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020060", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020061", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020062", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020063", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020064", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020065", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020066", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020067", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020068", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020069", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020070", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020071", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020072", "type"=>"Integer", "len"=>4},
 {"id"=>"P0020073", "type"=>"Integer", "len"=>4}]

part2_cols=[
 {"id"=>"P0030001", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030002", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030003", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030004", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030005", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030006", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030007", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030008", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030009", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030010", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030011", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030012", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030013", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030014", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030015", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030016", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030017", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030018", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030019", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030020", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030021", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030022", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030023", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030024", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030025", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030026", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030027", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030028", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030029", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030030", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030031", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030032", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030033", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030034", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030035", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030036", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030037", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030038", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030039", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030040", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030041", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030042", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030043", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030044", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030045", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030046", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030047", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030048", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030049", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030050", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030051", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030052", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030053", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030054", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030055", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030056", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030057", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030058", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030059", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030060", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030061", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030062", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030063", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030064", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030065", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030066", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030067", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030068", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030069", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030070", "type"=>"Integer", "len"=>4},
 {"id"=>"P0030071", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040001", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040002", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040003", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040004", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040005", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040006", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040007", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040008", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040009", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040010", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040011", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040012", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040013", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040014", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040015", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040016", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040017", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040018", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040019", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040020", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040021", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040022", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040023", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040024", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040025", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040026", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040027", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040028", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040029", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040030", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040031", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040032", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040033", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040034", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040035", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040036", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040037", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040038", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040039", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040040", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040041", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040042", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040043", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040044", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040045", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040046", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040047", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040048", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040049", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040050", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040051", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040052", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040053", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040054", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040055", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040056", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040057", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040058", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040059", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040060", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040061", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040062", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040063", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040064", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040065", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040066", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040067", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040068", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040069", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040070", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040071", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040072", "type"=>"Integer", "len"=>4},
 {"id"=>"P0040073", "type"=>"Integer", "len"=>4},
 {"id"=>"H0010001", "type"=>"Integer", "len"=>4},
 {"id"=>"H0010002", "type"=>"Integer", "len"=>4},
 {"id"=>"H0010003", "type"=>"Integer", "len"=>4}]

cols=part1_cols.map {|x| "\"#{x['id']}\" = #{stage_name}.\"#{x['id']}\""} * ", "
File.open("update_part1_to_final.sql","w") {|f| f<<"UPDATE #{table_name} SET #{cols} FROM #{stage_name} WHERE #{table_name}.\"LOGRECNO\" = #{stage_name}.\"LOGRECNO\";"}

stage_name = "pt2_staging"
cols=part2_cols.map {|x| "\"#{x['id']}\" = #{stage_name}.\"#{x['id']}\""} * ", "
File.open("update_part2_to_final.sql","w") {|f| f<<"UPDATE #{table_name} SET #{cols} FROM #{stage_name} WHERE #{table_name}.\"LOGRECNO\" = #{stage_name}.\"LOGRECNO\" AND #{table_name}.\"STUSAB\" = #{stage_name}.\"STUSAB\";"}